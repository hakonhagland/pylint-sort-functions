

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Developer Guide &mdash; pylint-sort-functions 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2709fde1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Privacy Fixer System" href="privacy.html" />
    <link rel="prev" title="API Reference" href="api.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pylint-sort-functions
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Auto-Fix Tool Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="workarounds.html">Known Issues &amp; Workarounds</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Configuration:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pylintrc.html">PyLint Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="sorting.html">Function and Method Sorting Algorithm</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Developer Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pylint-plugin-architecture">PyLint Plugin Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pylint-plugin-system">PyLint Plugin System</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plugin-entry-point">Plugin Entry Point</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#plugin-configuration">Plugin Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration-options">Configuration Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-integration">Configuration Integration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#core-components">Core Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#plugin-registration-init-py">1. Plugin Registration (<code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#message-definitions-messages-py">2. Message Definitions (<code class="docutils literal notranslate"><span class="pre">messages.py</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#main-checker-checker-py">3. Main Checker (<code class="docutils literal notranslate"><span class="pre">checker.py</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#utility-functions-utils-py">4. Utility Functions (<code class="docutils literal notranslate"><span class="pre">utils.py</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#auto-fix-tool-auto-fix-py">5. Auto-fix Tool (<code class="docutils literal notranslate"><span class="pre">auto_fix.py</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-line-interface-cli-py">6. Command-line Interface (<code class="docutils literal notranslate"><span class="pre">cli.py</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ast-and-pylint-integration-details">AST and PyLint Integration Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#abstract-syntax-tree-ast">Abstract Syntax Tree (AST)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#visitor-pattern">Visitor Pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="#message-reporting">Message Reporting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sorting-algorithm">Sorting Algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#framework-integration">Framework Integration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-features">Advanced Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#import-analysis">Import Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#extending-the-plugin">Extending the Plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adding-new-messages">Adding New Messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-new-validation-rules">Adding New Validation Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#framework-support">Framework Support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#development-workflow">Development Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-development-environment">Setting Up Development Environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="#environment-setup">Environment Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#alternative-setup-pip">Alternative Setup (pip)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#testing-quality-assurance">Testing &amp; Quality Assurance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-quality-checks">Code Quality Checks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#debugging-tips">Debugging Tips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ast-inspection">AST Inspection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pylint-integration-debug">PyLint Integration Debug</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#performance-considerations">Performance Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#core-performance-features">Core Performance Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#caching-optimizations">Caching Optimizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#performance-benchmarks">Performance Benchmarks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#conclusion">Conclusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="privacy.html">Privacy Fixer System</a></li>
<li class="toctree-l1"><a class="reference internal" href="claude.html">Claude Code Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="validation-system.html">Documentation Validation System</a></li>
<li class="toctree-l1"><a class="reference internal" href="release.html">Release Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Development Roadmap</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pylint-sort-functions</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Developer Guide</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/hakonhagland/pylint-sort-functions/blob/main/docs/developer.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="developer-guide">
<h1>Developer Guide<a class="headerlink" href="#developer-guide" title="Link to this heading"></a></h1>
<p>This guide explains the internal architecture of the <code class="docutils literal notranslate"><span class="pre">pylint-sort-functions</span></code> plugin and how it integrates with PyLint to enforce function and method sorting.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">pylint-sort-functions</span></code> plugin is a PyLint checker that enforces alphabetical sorting of functions and methods within Python modules and classes. It consists of two main components:</p>
<ol class="arabic simple">
<li><p><strong>PyLint Plugin</strong>: Integrates with PyLint’s checking framework to report sorting violations</p></li>
<li><p><strong>Auto-fix Tool</strong>: Standalone tool that can automatically reorder functions to fix violations</p></li>
</ol>
</section>
<section id="pylint-plugin-architecture">
<h2>PyLint Plugin Architecture<a class="headerlink" href="#pylint-plugin-architecture" title="Link to this heading"></a></h2>
<section id="pylint-plugin-system">
<h3>PyLint Plugin System<a class="headerlink" href="#pylint-plugin-system" title="Link to this heading"></a></h3>
<p>PyLint uses a plugin system where external checkers can be loaded and integrated into the linting process. The plugin system works as follows:</p>
<ol class="arabic simple">
<li><p><strong>Plugin Discovery</strong>: PyLint discovers plugins through entry points defined in <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code></p></li>
<li><p><strong>Registration</strong>: PyLint calls the plugin’s <code class="docutils literal notranslate"><span class="pre">register()</span></code> function to register checkers</p></li>
<li><p><strong>AST Traversal</strong>: PyLint parses Python code into an Abstract Syntax Tree (AST) using <code class="docutils literal notranslate"><span class="pre">astroid</span></code></p></li>
<li><p><strong>Visitor Pattern</strong>: PyLint calls <code class="docutils literal notranslate"><span class="pre">visit_*</span></code> methods on registered checkers for each AST node</p></li>
<li><p><strong>Message Reporting</strong>: Checkers call <code class="docutils literal notranslate"><span class="pre">self.add_message()</span></code> to report violations</p></li>
</ol>
</section>
<section id="plugin-entry-point">
<h3>Plugin Entry Point<a class="headerlink" href="#plugin-entry-point" title="Link to this heading"></a></h3>
<p>The plugin entry point is defined in <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[project.entry-points.</span><span class="s2">&quot;pylint.plugins&quot;</span><span class="k">]</span>
<span class="n">pylint_sort_functions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;pylint_sort_functions&quot;</span>
</pre></div>
</div>
<p>When PyLint loads the plugin, it imports the package and calls the <code class="docutils literal notranslate"><span class="pre">register()</span></code> function from <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>.</p>
</section>
</section>
<section id="plugin-configuration">
<h2>Plugin Configuration<a class="headerlink" href="#plugin-configuration" title="Link to this heading"></a></h2>
<p>The plugin supports configuration options that can be set in <code class="docutils literal notranslate"><span class="pre">.pylintrc</span></code> or <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> files to customize its behavior.</p>
<section id="configuration-options">
<h3>Configuration Options<a class="headerlink" href="#configuration-options" title="Link to this heading"></a></h3>
<dl>
<dt><strong>public-api-patterns</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csv (comma-separated values)</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">main,run,execute,start,stop,setup,teardown</span></code></p>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of function names to always treat as public API. These functions will not be flagged for privacy even if only used internally. Useful for entry points and framework callbacks.</p>
</dd>
</dl>
<p>Example usage in <code class="docutils literal notranslate"><span class="pre">.pylintrc</span></code>:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[function-sort]</span>
<span class="na">public-api-patterns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">main,run,setup,teardown,app_factory</span>
</pre></div>
</div>
<p>Example usage in <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.pylint.</span><span class="s2">&quot;function-sort&quot;</span><span class="k">]</span>
<span class="n">public-api-patterns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;main&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;run&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;setup&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;teardown&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;app_factory&quot;</span><span class="p">]</span>
</pre></div>
</div>
</dd>
<dt><strong>enable-privacy-detection</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>yn (yes/no boolean)</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">yes</span></code></p>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p>Enable detection of functions that should be made private based on usage analysis. When enabled, the plugin performs cross-module import analysis to detect functions that are only used internally and suggests making them private.</p>
</dd>
</dl>
<p>Example usage in <code class="docutils literal notranslate"><span class="pre">.pylintrc</span></code>:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[function-sort]</span>
<span class="na">enable-privacy-detection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">no</span>
</pre></div>
</div>
<p>Example usage in <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.pylint.</span><span class="s2">&quot;function-sort&quot;</span><span class="k">]</span>
<span class="n">enable-privacy-detection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
</pre></div>
</div>
</dd>
</dl>
</section>
<section id="configuration-integration">
<h3>Configuration Integration<a class="headerlink" href="#configuration-integration" title="Link to this heading"></a></h3>
<p>The plugin integrates with PyLint’s configuration system through the <code class="docutils literal notranslate"><span class="pre">options</span></code> class attribute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">FunctionSortChecker</span><span class="p">(</span><span class="n">BaseChecker</span><span class="p">):</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="s2">&quot;public-api-patterns&quot;</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;main&quot;</span><span class="p">,</span> <span class="s2">&quot;run&quot;</span><span class="p">,</span> <span class="s2">&quot;execute&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;csv&quot;</span><span class="p">,</span>
            <span class="s2">&quot;help&quot;</span><span class="p">:</span> <span class="s2">&quot;Function names to always treat as public API&quot;</span>
        <span class="p">}),</span>
        <span class="p">(</span><span class="s2">&quot;enable-privacy-detection&quot;</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;yn&quot;</span><span class="p">,</span>
            <span class="s2">&quot;help&quot;</span><span class="p">:</span> <span class="s2">&quot;Enable privacy detection based on usage analysis&quot;</span>
        <span class="p">}),</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>These options are accessible in checker methods via <code class="docutils literal notranslate"><span class="pre">self.linter.config</span></code>, allowing the plugin to adapt its behavior based on project-specific requirements.</p>
</section>
</section>
<section id="core-components">
<h2>Core Components<a class="headerlink" href="#core-components" title="Link to this heading"></a></h2>
<section id="plugin-registration-init-py">
<h3>1. Plugin Registration (<code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>)<a class="headerlink" href="#plugin-registration-init-py" title="Link to this heading"></a></h3>
<p><strong>Purpose</strong>: Entry point for PyLint plugin system</p>
<p><strong>Key Function</strong>:
- <code class="docutils literal notranslate"><span class="pre">register(linter:</span> <span class="pre">PyLinter)</span> <span class="pre">-&gt;</span> <span class="pre">None</span></code>: Required by PyLint, registers the <code class="docutils literal notranslate"><span class="pre">FunctionSortChecker</span></code></p>
<p><strong>Integration Point</strong>: This is where PyLint discovers and loads our checker.</p>
</section>
<section id="message-definitions-messages-py">
<h3>2. Message Definitions (<code class="docutils literal notranslate"><span class="pre">messages.py</span></code>)<a class="headerlink" href="#message-definitions-messages-py" title="Link to this heading"></a></h3>
<p><strong>Purpose</strong>: Defines all warning messages that the plugin can report</p>
<p><strong>Structure</strong>: Each message is a tuple containing:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">message_template</span></code>: Text shown to users (supports <code class="docutils literal notranslate"><span class="pre">%s</span></code> formatting)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">message_symbol</span></code>: Human-readable name for disabling (e.g., <code class="docutils literal notranslate"><span class="pre">unsorted-functions</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">message_description</span></code>: Detailed explanation</p></li>
</ul>
<p><strong>Message IDs</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">W9001</span></code>: <code class="docutils literal notranslate"><span class="pre">unsorted-functions</span></code> - Functions not sorted alphabetically</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">W9002</span></code>: <code class="docutils literal notranslate"><span class="pre">unsorted-methods</span></code> - Class methods not sorted alphabetically</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">W9003</span></code>: <code class="docutils literal notranslate"><span class="pre">mixed-function-visibility</span></code> - Public/private functions not properly separated</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">W9004</span></code>: <code class="docutils literal notranslate"><span class="pre">function-should-be-private</span></code> - Function should be marked private</p></li>
</ul>
<p><strong>Usage in Checker</strong>: The checker calls <code class="docutils literal notranslate"><span class="pre">self.add_message(&quot;unsorted-functions&quot;,</span> <span class="pre">node=node,</span> <span class="pre">args=(&quot;module&quot;,))</span></code></p>
</section>
<section id="main-checker-checker-py">
<h3>3. Main Checker (<code class="docutils literal notranslate"><span class="pre">checker.py</span></code>)<a class="headerlink" href="#main-checker-checker-py" title="Link to this heading"></a></h3>
<p><strong>Purpose</strong>: The core PyLint checker that performs sorting validation</p>
<p><strong>Class</strong>: <code class="docutils literal notranslate"><span class="pre">FunctionSortChecker(BaseChecker)</span></code></p>
<p><strong>PyLint Integration</strong>:</p>
<ul class="simple">
<li><p>Inherits from <code class="docutils literal notranslate"><span class="pre">pylint.checkers.BaseChecker</span></code></p></li>
<li><p>Defines <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">=</span> <span class="pre">&quot;function-sort&quot;</span></code> for PyLint identification</p></li>
<li><p>Uses <code class="docutils literal notranslate"><span class="pre">msgs</span> <span class="pre">=</span> <span class="pre">messages.MESSAGES</span></code> to register available messages</p></li>
</ul>
<p><strong>Visitor Methods</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">visit_module(node:</span> <span class="pre">nodes.Module)</span></code>: Called for each module, checks function sorting</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">visit_classdef(node:</span> <span class="pre">nodes.ClassDef)</span></code>: Called for each class, checks method sorting</p></li>
</ul>
<p><strong>Privacy Detection Methods</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_check_function_privacy(functions,</span> <span class="pre">node)</span></code>: Main privacy detection using import analysis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_check_function_privacy_heuristic(functions,</span> <span class="pre">node)</span></code>: Fallback privacy detection (currently no-op)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_get_module_path()</span></code>: Extract current module’s file path from PyLint’s linter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_get_project_root(module_path)</span></code>: Find project root by searching for common markers</p></li>
</ul>
<p><strong>Privacy Detection Process</strong>:</p>
<ol class="arabic simple">
<li><p><strong>Configuration Check</strong>: Verify <code class="docutils literal notranslate"><span class="pre">enable-privacy-detection</span></code> is enabled</p></li>
<li><p><strong>Path Resolution</strong>: Get module path and determine project root directory</p></li>
<li><p><strong>Pattern Matching</strong>: Collect <code class="docutils literal notranslate"><span class="pre">public-api-patterns</span></code> from configuration</p></li>
<li><p><strong>Import Analysis</strong>: Use <code class="docutils literal notranslate"><span class="pre">utils.should_function_be_private()</span></code> to analyze cross-module usage</p></li>
<li><p><strong>Message Reporting</strong>: Report <code class="docutils literal notranslate"><span class="pre">W9004</span></code> (function-should-be-private) for internal-only functions</p></li>
</ol>
<p>The privacy detection gracefully falls back to heuristic mode when path information is unavailable (rare in normal PyLint usage).</p>
<p><strong>Automatic Privacy Fixing</strong>: The plugin also includes an experimental privacy fixer system that can automatically rename functions identified by W9004 to be private. For complete technical details about the privacy fixer architecture, safety validation, and implementation status, see <a class="reference internal" href="privacy.html"><span class="doc">Privacy Fixer System</span></a>.</p>
<p><strong>AST Analysis Flow</strong>:</p>
<ol class="arabic simple">
<li><p>PyLint parses Python code using <code class="docutils literal notranslate"><span class="pre">astroid</span></code> (enhanced AST library)</p></li>
<li><p>PyLint walks the AST and calls visitor methods on our checker</p></li>
<li><p>Checker extracts functions/methods from AST nodes</p></li>
<li><p>Checker validates sorting using utility functions</p></li>
<li><p>Checker reports violations using <code class="docutils literal notranslate"><span class="pre">self.add_message()</span></code></p></li>
</ol>
</section>
<section id="utility-functions-utils-py">
<h3>4. Utility Functions (<code class="docutils literal notranslate"><span class="pre">utils.py</span></code>)<a class="headerlink" href="#utility-functions-utils-py" title="Link to this heading"></a></h3>
<p><strong>Purpose</strong>: Core logic for AST analysis and sorting validation</p>
<p><strong>Key Functions</strong>:</p>
<p><strong>Function Extraction</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get_functions_from_node(node:</span> <span class="pre">nodes.Module)</span></code>: Extract module-level functions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_methods_from_class(node:</span> <span class="pre">nodes.ClassDef)</span></code>: Extract class methods</p></li>
</ul>
<p><strong>Sorting Validation</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">are_functions_sorted(functions)</span></code>: Check alphabetical sorting within visibility scopes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">are_methods_sorted(methods)</span></code>: Check method sorting (same logic as functions)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">are_functions_properly_separated(functions)</span></code>: Check public/private separation</p></li>
</ul>
<p><strong>Advanced Features</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">are_functions_sorted_with_exclusions()</span></code>: Framework-aware sorting with decorator exclusions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">should_function_be_private(func,</span> <span class="pre">module_path,</span> <span class="pre">project_root,</span> <span class="pre">public_patterns=None)</span></code>: Detect functions that should be private based on cross-module import analysis</p></li>
</ul>
<p><strong>Privacy Detection</strong>:
The plugin includes sophisticated import analysis to suggest when public functions should be private:</p>
<p><strong>Function Signature</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">should_function_be_private</span><span class="p">(</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">FunctionDef</span><span class="p">,</span>
    <span class="n">module_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">project_root</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">public_patterns</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Detect if a function should be private based on import analysis.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p><strong>Detection Process</strong>:</p>
<ol class="arabic simple">
<li><p><strong>Skip Already Private</strong>: Functions with underscore prefix are ignored</p></li>
<li><p><strong>Skip Special Methods</strong>: Dunder methods (<code class="docutils literal notranslate"><span class="pre">__init__</span></code>, <code class="docutils literal notranslate"><span class="pre">__str__</span></code>) are ignored</p></li>
<li><p><strong>Apply Public Patterns</strong>: Functions matching configurable patterns (<code class="docutils literal notranslate"><span class="pre">main</span></code>, <code class="docutils literal notranslate"><span class="pre">run</span></code>, <code class="docutils literal notranslate"><span class="pre">setup</span></code>) are treated as public API</p></li>
<li><p><strong>Cross-Module Analysis</strong>: Uses <code class="docutils literal notranslate"><span class="pre">_build_cross_module_usage_graph()</span></code> to check if function is imported elsewhere</p></li>
<li><p><strong>Privacy Suggestion</strong>: Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if function is only used internally</p></li>
</ol>
<p><strong>Parameters</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code>: AST node of the function to analyze</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">module_path</span></code>: File path of the current module (for relative path calculation)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">project_root</span></code>: Project root directory (for import scanning scope)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">public_patterns</span></code>: Custom public API patterns (defaults to <code class="docutils literal notranslate"><span class="pre">main</span></code>, <code class="docutils literal notranslate"><span class="pre">run</span></code>, <code class="docutils literal notranslate"><span class="pre">execute</span></code>, etc.)</p></li>
</ul>
<p>This real usage analysis provides accurate detection with minimal false positives.</p>
<p><strong>Helper Functions</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_is_dunder_method(func)</span></code>: Detects special methods like <code class="docutils literal notranslate"><span class="pre">__init__</span></code>, <code class="docutils literal notranslate"><span class="pre">__str__</span></code> that should remain public</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_extract_attribute_accesses(tree,</span> <span class="pre">imported_modules,</span> <span class="pre">attribute_accesses)</span></code>: Analyzes AST for dot notation patterns (<code class="docutils literal notranslate"><span class="pre">module.function</span></code>) during import analysis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_is_unittest_file(module_name)</span></code>: Identifies test files to exclude from API analysis (tests access internals without indicating public API)</p></li>
</ul>
<p>These helper functions support the main import analysis workflow while maintaining code clarity and modularity.</p>
</section>
<section id="auto-fix-tool-auto-fix-py">
<h3>5. Auto-fix Tool (<code class="docutils literal notranslate"><span class="pre">auto_fix.py</span></code>)<a class="headerlink" href="#auto-fix-tool-auto-fix-py" title="Link to this heading"></a></h3>
<p><strong>Purpose</strong>: Standalone tool for automatically reordering functions</p>
<p><strong>Key Classes</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">AutoFixConfig</span></code>: Configuration for auto-fix behavior</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FunctionSorter</span></code>: Main auto-fix implementation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FunctionSpan</span></code>: Represents a function with its text span in source</p></li>
</ul>
<p><strong>Process</strong>:</p>
<ol class="arabic simple">
<li><p>Parse file content with <code class="docutils literal notranslate"><span class="pre">astroid</span></code> (same as checker)</p></li>
<li><p>Extract function and method text spans from source <strong>with comment preservation</strong></p></li>
<li><p>Sort functions/methods according to plugin rules (public first, then alphabetical within visibility scopes)</p></li>
<li><p>Reconstruct file content with sorted functions/methods and their associated comments</p></li>
</ol>
<p><strong>Dual-Level Sorting Support</strong>:</p>
<ul class="simple">
<li><p><strong>Module-Level Functions</strong>: Sorts functions at the module level using <code class="docutils literal notranslate"><span class="pre">_sort_module_functions()</span></code></p></li>
<li><p><strong>Class Method Sorting</strong>: Sorts methods within each class using <code class="docutils literal notranslate"><span class="pre">_sort_class_methods()</span></code></p></li>
<li><p><strong>Comment Preservation</strong>: Both function and method sorting preserve associated comments</p></li>
<li><p><strong>Mixed Content</strong>: Handles files with both module functions and class methods simultaneously</p></li>
</ul>
<p><strong>Comment Preservation Feature</strong>:</p>
<p>The auto-fix tool preserves comments that belong to functions during reordering:</p>
<p><strong>Comment Detection Process</strong>:</p>
<ol class="arabic simple">
<li><p><strong>Backward Scanning</strong>: For each function, scan backwards from the function definition</p></li>
<li><p><strong>Comment Association</strong>: Identify comment lines that precede the function (including decorators)</p></li>
<li><p><strong>Boundary Detection</strong>: Determine where function-specific comments start vs. general file comments</p></li>
<li><p><strong>Span Calculation</strong>: Include comment lines in the function’s text span for movement</p></li>
</ol>
<p><strong>Implementation Method</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_find_comments_above_function(lines,</span> <span class="pre">function_start_line)</span></code>: Scans backwards to find associated comments</p></li>
<li><p><strong>Empty Line Handling</strong>: Allows gaps between comments and function definitions</p></li>
<li><p><strong>Decorator Support</strong>: Comments above decorators are included with the function</p></li>
<li><p><strong>Conservative Approach</strong>: Only includes comments directly above functions to avoid misattribution</p></li>
</ul>
<p>This ensures that functions retain their documentation and explanatory comments when reordered, maintaining code readability and intent.</p>
<p><strong>Key Auto-fix Methods</strong>:</p>
<p><strong>Function/Method Extraction</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_extract_function_spans(functions,</span> <span class="pre">lines)</span></code>: Extract module-level function spans with comments</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_extract_method_spans(methods,</span> <span class="pre">lines,</span> <span class="pre">class_node)</span></code>: Extract class method spans with comments</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_find_comments_above_function(lines,</span> <span class="pre">function_start_line)</span></code>: Find and associate comments with functions</p></li>
</ul>
<p><strong>Content Reconstruction</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_reconstruct_content_with_sorted_functions(content,</span> <span class="pre">original_spans,</span> <span class="pre">sorted_spans)</span></code>: Rebuild module with sorted functions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_reconstruct_class_with_sorted_methods(content,</span> <span class="pre">original_spans,</span> <span class="pre">sorted_spans)</span></code>: Rebuild class with sorted methods</p></li>
</ul>
<p><strong>Sorting Logic</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_sort_function_spans(spans)</span></code>: Apply sorting rules to function spans (public first, then alphabetical)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_sort_module_functions(functions,</span> <span class="pre">content)</span></code>: Handle module-level function sorting workflow</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_sort_class_methods(methods,</span> <span class="pre">content,</span> <span class="pre">class_node)</span></code>: Handle class method sorting workflow</p></li>
</ul>
<p><strong>Utility Methods</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_file_needs_sorting(content)</span></code>: Determine if file requires reordering (optimization)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_sort_functions_in_content(content)</span></code>: Main entry point for content transformation</p></li>
</ul>
<p><strong>Integration with Checker</strong>: Uses the same utility functions as the checker for consistency.</p>
</section>
<section id="command-line-interface-cli-py">
<h3>6. Command-line Interface (<code class="docutils literal notranslate"><span class="pre">cli.py</span></code>)<a class="headerlink" href="#command-line-interface-cli-py" title="Link to this heading"></a></h3>
<p><strong>Purpose</strong>: Provides CLI for the auto-fix tool</p>
<p><strong>CLI Operation Modes</strong>:</p>
<ol class="arabic simple">
<li><p><strong>Check-Only Mode</strong> (default): Shows recommendations without modifying files</p></li>
<li><p><strong>Dry-Run Mode</strong> (<code class="docutils literal notranslate"><span class="pre">--dry-run</span></code>): Previews changes without modifying files</p></li>
<li><p><strong>Fix Mode</strong> (<code class="docutils literal notranslate"><span class="pre">--fix</span></code>): Actually applies changes to files</p></li>
</ol>
<p><strong>Key Features</strong>:</p>
<ul class="simple">
<li><p><strong>File/Directory Processing</strong>: Accepts single files, directories, or multiple paths</p></li>
<li><p><strong>Path Validation</strong>: Checks file/directory existence before processing</p></li>
<li><p><strong>Backup Creation</strong>: Automatically creates <code class="docutils literal notranslate"><span class="pre">.bak</span></code> files (can be disabled with <code class="docutils literal notranslate"><span class="pre">--no-backup</span></code>)</p></li>
<li><p><strong>Verbose Output</strong> (<code class="docutils literal notranslate"><span class="pre">--verbose</span></code>, <code class="docutils literal notranslate"><span class="pre">-v</span></code>): Detailed processing information and progress reporting</p></li>
<li><p><strong>Decorator Exclusion Patterns</strong>: Framework-aware sorting with <code class="docutils literal notranslate"><span class="pre">--ignore-decorators</span></code> (supports multiple patterns)</p></li>
<li><p><strong>Exit Codes</strong>: Standard exit codes for CI/CD integration (0=success, 1=error, 2=invalid usage)</p></li>
</ul>
<p><strong>User Experience Features</strong>:</p>
<ul class="simple">
<li><p><strong>Help Text</strong>: Comprehensive usage instructions and examples</p></li>
<li><p><strong>Error Handling</strong>: Clear error messages with actionable guidance</p></li>
<li><p><strong>Progress Reporting</strong>: File-by-file processing status in verbose mode</p></li>
<li><p><strong>Zero Dependencies</strong>: Minimal installation footprint (only PyLint/astroid dependencies)</p></li>
</ul>
</section>
</section>
<section id="ast-and-pylint-integration-details">
<h2>AST and PyLint Integration Details<a class="headerlink" href="#ast-and-pylint-integration-details" title="Link to this heading"></a></h2>
<section id="abstract-syntax-tree-ast">
<h3>Abstract Syntax Tree (AST)<a class="headerlink" href="#abstract-syntax-tree-ast" title="Link to this heading"></a></h3>
<p>The plugin works with <code class="docutils literal notranslate"><span class="pre">astroid</span></code> nodes, which are enhanced AST nodes:</p>
<p><strong>Key Node Types</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">nodes.Module</span></code>: Represents a Python module</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nodes.ClassDef</span></code>: Represents a class definition</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nodes.FunctionDef</span></code>: Represents a function/method definition</p></li>
</ul>
<p><strong>Node Properties</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">node.name</span></code>: Function/class name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">node.lineno</span></code>: Line number in source</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">node.body</span></code>: List of child nodes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">node.decorators</span></code>: Decorator information</p></li>
</ul>
</section>
<section id="visitor-pattern">
<h3>Visitor Pattern<a class="headerlink" href="#visitor-pattern" title="Link to this heading"></a></h3>
<p>PyLint uses the visitor pattern to traverse AST nodes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">FunctionSortChecker</span><span class="p">(</span><span class="n">BaseChecker</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">visit_module</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Called once per module</span>
        <span class="n">functions</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_functions_from_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="c1"># Analyze and report violations</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">visit_classdef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Called once per class definition</span>
        <span class="n">methods</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_methods_from_class</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="c1"># Analyze and report violations</span>
</pre></div>
</div>
</section>
<section id="message-reporting">
<h3>Message Reporting<a class="headerlink" href="#message-reporting" title="Link to this heading"></a></h3>
<p>When violations are found, the checker reports them to PyLint:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">add_message</span><span class="p">(</span>
    <span class="s2">&quot;unsorted-functions&quot;</span><span class="p">,</span>    <span class="c1"># Message ID (from messages.py)</span>
    <span class="n">node</span><span class="o">=</span><span class="n">node</span><span class="p">,</span>               <span class="c1"># AST node where violation occurs</span>
    <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;module&quot;</span><span class="p">,)</span>         <span class="c1"># Arguments for message template</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This creates output like:
<code class="docutils literal notranslate"><span class="pre">W9001:</span> <span class="pre">Functions</span> <span class="pre">are</span> <span class="pre">not</span> <span class="pre">sorted</span> <span class="pre">alphabetically</span> <span class="pre">in</span> <span class="pre">module</span> <span class="pre">scope</span> <span class="pre">(unsorted-functions)</span></code></p>
</section>
</section>
<section id="sorting-algorithm">
<h2>Sorting Algorithm<a class="headerlink" href="#sorting-algorithm" title="Link to this heading"></a></h2>
<p>The plugin implements a comprehensive sorting algorithm for organizing Python functions and methods. For complete details about sorting rules, examples, and configuration options, see <a class="reference internal" href="sorting.html"><span class="doc">Function and Method Sorting Algorithm</span></a>.</p>
<p><strong>Key Implementation Points:</strong></p>
<ul class="simple">
<li><p><strong>Dual-Level Processing</strong>: Handles both module-level functions and class methods</p></li>
<li><p><strong>AST-Based Analysis</strong>: Uses <code class="docutils literal notranslate"><span class="pre">astroid</span></code> for consistent parsing with PyLint</p></li>
<li><p><strong>Comment Preservation</strong>: Maintains function-associated comments during reordering</p></li>
<li><p><strong>Section Header Integration</strong>: Optional automatic insertion of organizational headers</p></li>
<li><p><strong>Framework Compatibility</strong>: Supports decorator-based exclusions for frameworks</p></li>
</ul>
<section id="framework-integration">
<h3>Framework Integration<a class="headerlink" href="#framework-integration" title="Link to this heading"></a></h3>
<p>The plugin supports framework-aware sorting through decorator exclusions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># These might need to stay in specific order due to framework requirements</span>
<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">home</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/users&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">users</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="c1"># Regular functions still get sorted</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">():</span>
    <span class="k">pass</span>
</pre></div>
</div>
</section>
</section>
<section id="advanced-features">
<h2>Advanced Features<a class="headerlink" href="#advanced-features" title="Link to this heading"></a></h2>
<section id="import-analysis">
<h3>Import Analysis<a class="headerlink" href="#import-analysis" title="Link to this heading"></a></h3>
<p>The plugin analyzes cross-module imports to detect functions that should be private:</p>
<ol class="arabic simple">
<li><p><strong>Project Scanning</strong>: Scans all Python files in the project</p></li>
<li><p><strong>Import Extraction</strong>: Extracts <code class="docutils literal notranslate"><span class="pre">import</span></code> and <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">module</span> <span class="pre">import</span> <span class="pre">function</span></code> statements</p></li>
<li><p><strong>Usage Detection</strong>: Determines which functions are used outside their defining module</p></li>
<li><p><strong>Privacy Suggestions</strong>: Suggests making functions private if they’re only used internally</p></li>
</ol>
<p>This real usage analysis provides accurate detection with minimal false positives.</p>
</section>
<section id="testing">
<h3>Testing<a class="headerlink" href="#testing" title="Link to this heading"></a></h3>
<p>For comprehensive testing documentation including unit tests, integration testing,
and the Docker validation system, see <a class="reference internal" href="testing.html"><span class="doc">Testing</span></a>.</p>
</section>
</section>
<section id="extending-the-plugin">
<h2>Extending the Plugin<a class="headerlink" href="#extending-the-plugin" title="Link to this heading"></a></h2>
<section id="adding-new-messages">
<h3>Adding New Messages<a class="headerlink" href="#adding-new-messages" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Add message definition to <code class="docutils literal notranslate"><span class="pre">messages.py</span></code></p></li>
<li><p>Use it in checker with <code class="docutils literal notranslate"><span class="pre">self.add_message()</span></code></p></li>
<li><p>Add tests for the new message</p></li>
</ol>
</section>
<section id="adding-new-validation-rules">
<h3>Adding New Validation Rules<a class="headerlink" href="#adding-new-validation-rules" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Add validation logic to <code class="docutils literal notranslate"><span class="pre">utils.py</span></code></p></li>
<li><p>Call from appropriate visitor method in <code class="docutils literal notranslate"><span class="pre">checker.py</span></code></p></li>
<li><p>Consider auto-fix support in <code class="docutils literal notranslate"><span class="pre">auto_fix.py</span></code></p></li>
</ol>
</section>
<section id="framework-support">
<h3>Framework Support<a class="headerlink" href="#framework-support" title="Link to this heading"></a></h3>
<p>To add support for new frameworks:</p>
<ol class="arabic simple">
<li><p>Extend decorator pattern matching in <code class="docutils literal notranslate"><span class="pre">utils.py</span></code></p></li>
<li><p>Add framework-specific decorator patterns</p></li>
<li><p>Update configuration options</p></li>
<li><p>Add tests with framework-specific code</p></li>
</ol>
</section>
</section>
<section id="development-workflow">
<h2>Development Workflow<a class="headerlink" href="#development-workflow" title="Link to this heading"></a></h2>
<section id="setting-up-development-environment">
<h3>Setting Up Development Environment<a class="headerlink" href="#setting-up-development-environment" title="Link to this heading"></a></h3>
<section id="prerequisites">
<h4>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading"></a></h4>
<ol class="arabic">
<li><p><strong>Python Version Management</strong> (recommended):</p>
<p>Install <a class="reference external" href="https://github.com/pyenv/pyenv">pyenv</a> to manage multiple Python versions:</p>
<ul class="simple">
<li><p>Install the Python versions listed in <a class="reference external" href=".python-version">.python-version</a></p></li>
<li><p>This ensures compatibility testing across supported versions</p></li>
</ul>
</li>
<li><p><strong>Package Manager</strong>:</p>
<p>Install <a class="reference external" href="https://github.com/astral-sh/uv">uv</a> for fast, reliable dependency management:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Linux and macOS</span>
curl<span class="w"> </span>-LsSf<span class="w"> </span>https://astral.sh/uv/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh
<span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/.cargo/bin:</span><span class="nv">$PATH</span><span class="s2">&quot;</span>

<span class="c1"># Windows (PowerShell)</span>
powershell<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;irm https://astral.sh/uv/install.ps1 | iex&quot;</span>
<span class="c1"># Add %USERPROFILE%\.cargo\bin to your PATH</span>
</pre></div>
</div>
</li>
<li><p><strong>Make command</strong> (Windows only):</p>
<ul class="simple">
<li><p>Install via <a class="reference external" href="https://chocolatey.org/install">Chocolatey</a>: <code class="docutils literal notranslate"><span class="pre">choco</span> <span class="pre">install</span> <span class="pre">make</span></code></p></li>
<li><p>Or use <a class="reference external" href="https://git-scm.com/download/win">Git Bash</a> which includes <code class="docutils literal notranslate"><span class="pre">make</span></code></p></li>
</ul>
</li>
</ol>
</section>
<section id="environment-setup">
<h4>Environment Setup<a class="headerlink" href="#environment-setup" title="Link to this heading"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create virtual environment (uses first Python version from .python-version)</span>
uv<span class="w"> </span>venv

<span class="c1"># Activate virtual environment</span>
<span class="nb">source</span><span class="w"> </span>.venv/bin/activate<span class="w">      </span><span class="c1"># Linux/macOS</span>
.venv<span class="se">\S</span>cripts<span class="se">\a</span>ctivate<span class="w">          </span><span class="c1"># Windows</span>

<span class="c1"># Install dependencies</span>
uv<span class="w"> </span>sync<span class="w">                         </span><span class="c1"># Uses default Python version</span>
<span class="c1"># or specify version:</span>
uv<span class="w"> </span>sync<span class="w"> </span>--python<span class="o">=</span><span class="m">3</span>.11

<span class="c1"># Install pre-commit hooks</span>
pre-commit<span class="w"> </span>install<span class="w"> </span>--hook-type<span class="w"> </span>pre-commit
pre-commit<span class="w"> </span>install<span class="w"> </span>--hook-type<span class="w"> </span>commit-msg

<span class="c1"># Verify setup</span>
make<span class="w"> </span>pre-commit<span class="w">                 </span><span class="c1"># Run all pre-commit checks</span>
make<span class="w"> </span><span class="nb">test</span><span class="w">                       </span><span class="c1"># Run test suite</span>
make<span class="w"> </span>coverage<span class="w">                   </span><span class="c1"># Generate coverage report</span>
</pre></div>
</div>
</section>
<section id="alternative-setup-pip">
<h4>Alternative Setup (pip)<a class="headerlink" href="#alternative-setup-pip" title="Link to this heading"></a></h4>
<p>If you prefer traditional pip:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create virtual environment</span>
python<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>.venv
<span class="nb">source</span><span class="w"> </span>.venv/bin/activate<span class="w">  </span><span class="c1"># or .venv\Scripts\activate on Windows</span>

<span class="c1"># Install in development mode</span>
pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.

<span class="c1"># Install development dependencies</span>
pip<span class="w"> </span>install<span class="w"> </span>pytest<span class="w"> </span>mypy<span class="w"> </span>ruff<span class="w"> </span>coverage<span class="w"> </span>pre-commit
</pre></div>
</div>
</section>
</section>
<section id="testing-quality-assurance">
<h3>Testing &amp; Quality Assurance<a class="headerlink" href="#testing-quality-assurance" title="Link to this heading"></a></h3>
<p>See <a class="reference internal" href="testing.html"><span class="doc">Testing</span></a> for complete testing documentation, including:</p>
<ul class="simple">
<li><p>Unit testing with PyLint’s framework</p></li>
<li><p>Plugin integration testing</p></li>
<li><p>Docker validation system for documentation examples</p></li>
<li><p>Framework-specific integration testing</p></li>
</ul>
<p>Quick test commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span><span class="nb">test</span><span class="w">                    </span><span class="c1"># Run unit tests</span>
make<span class="w"> </span>test-plugin<span class="w">             </span><span class="c1"># Test plugin with PyLint</span>
make<span class="w"> </span>test-documentation<span class="w">      </span><span class="c1"># Validate all documentation examples</span>
</pre></div>
</div>
</section>
<section id="code-quality-checks">
<h3>Code Quality Checks<a class="headerlink" href="#code-quality-checks" title="Link to this heading"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Type checking</span>
mypy<span class="w"> </span>src/<span class="w"> </span>tests/

<span class="c1"># Linting and formatting</span>
ruff<span class="w"> </span>check<span class="w"> </span>src<span class="w"> </span>tests
ruff<span class="w"> </span>format<span class="w"> </span>src<span class="w"> </span>tests

<span class="c1"># Coverage (must be 100%)</span>
coverage<span class="w"> </span>run<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>tests
coverage<span class="w"> </span>report<span class="w"> </span>-m
</pre></div>
</div>
</section>
</section>
<section id="debugging-tips">
<h2>Debugging Tips<a class="headerlink" href="#debugging-tips" title="Link to this heading"></a></h2>
<section id="ast-inspection">
<h3>AST Inspection<a class="headerlink" href="#ast-inspection" title="Link to this heading"></a></h3>
<p>To understand AST structure:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">astroid</span>
<span class="n">code</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">def function_name():</span>
<span class="s2">    pass</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">astroid</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">repr_tree</span><span class="p">())</span>  <span class="c1"># Shows AST structure</span>
</pre></div>
</div>
</section>
<section id="pylint-integration-debug">
<h3>PyLint Integration Debug<a class="headerlink" href="#pylint-integration-debug" title="Link to this heading"></a></h3>
<p>To debug PyLint integration:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run with verbose output</span>
pylint<span class="w"> </span>--load-plugins<span class="o">=</span>pylint_sort_functions<span class="w"> </span>--verbose<span class="w"> </span>src/

<span class="c1"># Enable specific message types</span>
pylint<span class="w"> </span>--enable<span class="o">=</span>unsorted-functions<span class="w"> </span>src/

<span class="c1"># Disable other checkers to focus on sorting</span>
pylint<span class="w"> </span>--load-plugins<span class="o">=</span>pylint_sort_functions<span class="w"> </span>--disable<span class="o">=</span>all<span class="w"> </span>--enable<span class="o">=</span>unsorted-functions<span class="w"> </span>src/
</pre></div>
</div>
</section>
</section>
<section id="performance-considerations">
<h2>Performance Considerations<a class="headerlink" href="#performance-considerations" title="Link to this heading"></a></h2>
<p>The plugin is designed for good performance with intelligent caching optimizations:</p>
<section id="core-performance-features">
<h3>Core Performance Features<a class="headerlink" href="#core-performance-features" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>AST Parsing</strong>: PyLint handles AST parsing, plugin only analyzes existing nodes</p></li>
<li><p><strong>Single Pass</strong>: Each file is processed once during PyLint’s normal operation</p></li>
<li><p><strong>Lazy Evaluation</strong>: Import analysis only performed when privacy detection is enabled</p></li>
<li><p><strong>Memory Usage</strong>: Minimal additional memory usage beyond PyLint’s normal operation</p></li>
</ul>
</section>
<section id="caching-optimizations">
<h3>Caching Optimizations<a class="headerlink" href="#caching-optimizations" title="Link to this heading"></a></h3>
<p>The plugin uses Python’s <code class="docutils literal notranslate"><span class="pre">&#64;lru_cache</span></code> decorator for significant performance improvements:</p>
<p><strong>File Import Analysis Caching</strong> (<code class="docutils literal notranslate"><span class="pre">&#64;lru_cache(maxsize=128)</span></code>):</p>
<ul class="simple">
<li><p>Function: <code class="docutils literal notranslate"><span class="pre">_extract_imports_from_file()</span></code></p></li>
<li><p><strong>Performance Impact</strong>: 50%+ improvement for projects with 100+ files</p></li>
<li><p><strong>Cache Key</strong>: File path + modification time (ensures cache invalidation on file changes)</p></li>
<li><p><strong>Benefit</strong>: Prevents redundant AST parsing of the same files during analysis</p></li>
</ul>
<p><strong>Cross-Module Usage Graph Caching</strong> (<code class="docutils literal notranslate"><span class="pre">&#64;lru_cache(maxsize=1)</span></code>):</p>
<ul class="simple">
<li><p>Function: <code class="docutils literal notranslate"><span class="pre">_build_cross_module_usage_graph()</span></code></p></li>
<li><p><strong>Performance Impact</strong>: Up to 146x speedup for repeated import analysis</p></li>
<li><p><strong>Cache Key</strong>: Project root path</p></li>
<li><p><strong>Benefit</strong>: Entire project scan is cached during a single PyLint run</p></li>
</ul>
<p><strong>File Modification Time Tracking</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cache invalidation strategy</span>
<span class="n">file_mtime</span> <span class="o">=</span> <span class="n">file_path</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime</span>
<span class="n">imports</span> <span class="o">=</span> <span class="n">_extract_imports_from_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">file_mtime</span><span class="p">)</span>
</pre></div>
</div>
<p>This ensures cache correctness when files change between analysis runs.</p>
<p><strong>Directory Filtering</strong>:</p>
<p>The plugin automatically skips performance-impacting directories:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__pycache__/</span></code>, <code class="docutils literal notranslate"><span class="pre">.pytest_cache/</span></code>, <code class="docutils literal notranslate"><span class="pre">.mypy_cache/</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.git/</span></code>, <code class="docutils literal notranslate"><span class="pre">.svn/</span></code>, <code class="docutils literal notranslate"><span class="pre">.venv/</span></code>, <code class="docutils literal notranslate"><span class="pre">node_modules/</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dist/</span></code>, <code class="docutils literal notranslate"><span class="pre">build/</span></code>, <code class="docutils literal notranslate"><span class="pre">*.egg-info/</span></code></p></li>
</ul>
</section>
<section id="performance-benchmarks">
<h3>Performance Benchmarks<a class="headerlink" href="#performance-benchmarks" title="Link to this heading"></a></h3>
<p><strong>Small Projects</strong> (&lt; 50 files):
- Negligible performance impact
- Import analysis adds ~50-100ms</p>
<p><strong>Medium Projects</strong> (50-200 files):
- With caching: ~200-500ms additional overhead
- Without caching: ~2-5 seconds (4-10x slower)</p>
<p><strong>Large Projects</strong> (200+ files):
- With caching: ~500ms-1s additional overhead
- Without caching: ~10+ seconds (20x+ slower)
- 146x speedup observed in real-world codebases</p>
<p><strong>Disabling Privacy Detection</strong>:</p>
<p>For performance-critical environments, privacy detection can be disabled:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[function-sort]</span>
<span class="na">enable-privacy-detection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">no</span>
</pre></div>
</div>
<p>This reduces the plugin to near-zero performance overhead while maintaining all sorting functionality.</p>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">pylint-sort-functions</span></code> plugin demonstrates a complete PyLint plugin implementation with:</p>
<ul class="simple">
<li><p>Proper integration with PyLint’s plugin system</p></li>
<li><p>AST-based code analysis using <code class="docutils literal notranslate"><span class="pre">astroid</span></code></p></li>
<li><p>Comprehensive message definitions and error reporting</p></li>
<li><p>Advanced features like import analysis and auto-fixing</p></li>
<li><p>Framework-aware sorting with decorator exclusions</p></li>
<li><p>Thorough testing using PyLint’s testing framework</p></li>
</ul>
<p>The modular architecture makes it easy to extend and maintain while providing a solid foundation for enforcing code organization standards.</p>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="release.html"><span class="doc">Release Management</span></a> - Release management and changelog workflow for contributors</p></li>
<li><p><a class="reference internal" href="claude.html"><span class="doc">Claude Code Guidelines</span></a> - Specific guidelines for Claude Code AI assistant</p></li>
<li><p><a class="reference internal" href="testing.html"><span class="doc">Testing</span></a> - Comprehensive testing guide</p></li>
<li><p><a class="reference internal" href="api.html"><span class="doc">API Reference</span></a> - Complete API reference</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="api.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="privacy.html" class="btn btn-neutral float-right" title="Privacy Fixer System" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Håkon Hægland.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>