[tox]
isolated_build = True
envlist = py311,py312,py313,quality

[testenv]
description = Run tests with coverage
allowlist_externals = uv
commands =
    uv sync --frozen
    uv run pytest tests/ --cov=src --cov-report=term-missing
    uv run coverage report --fail-under=100

[testenv:quality]
description = Run quality checks (linting, type checking, plugin self-check)
allowlist_externals = uv
commands =
    uv sync --frozen
    uv run mypy src/ tests/
    uv run ruff check src tests
    uv run pylint --load-plugins=pylint_sort_functions --disable=all --enable=unsorted-functions,unsorted-methods,mixed-function-visibility,function-should-be-private src/

[testenv:docs]
description = Build documentation
allowlist_externals = uv
commands =
    uv sync --frozen
    uv run sphinx-build -W -b html docs docs/_build/html
