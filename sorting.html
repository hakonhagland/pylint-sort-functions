

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Function and Method Sorting Algorithm &mdash; pylint-sort-functions 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2709fde1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="api.html" />
    <link rel="prev" title="PyLint Configuration" href="pylintrc.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pylint-sort-functions
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Auto-Fix Tool Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="workarounds.html">Configuration &amp; Limitations Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Configuration:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="pylintrc.html">PyLint Configuration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Function and Method Sorting Algorithm</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sorting-rules">Sorting Rules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-level-functions">Module-Level Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#class-methods">Class Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#special-method-handling">Special Method Handling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dunder-methods">Dunder Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#private-vs-public-classification">Private vs Public Classification</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#framework-integration">Framework Integration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#decorator-exclusions">Decorator Exclusions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#privacy-detection">Privacy Detection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#detection-algorithm">Detection Algorithm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-ast-based-boundary-detection">Advanced AST-Based Boundary Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comment-preservation">Comment Preservation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#automatic-section-headers">Automatic Section Headers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-section-header-detection">Custom Section Header Detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#when-headers-are-added">When Headers Are Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#message-types">Message Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#w9001-unsorted-functions">W9001: unsorted-functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#w9002-unsorted-methods">W9002: unsorted-methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#w9003-mixed-function-visibility">W9003: mixed-function-visibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="#w9004-function-should-be-private">W9004: function-should-be-private</a></li>
<li class="toctree-l3"><a class="reference internal" href="#w9005-function-should-be-public">W9005: function-should-be-public</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pylint-integration">PyLint Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cli-tool">CLI Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="#benefits">Benefits</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#consistency">Consistency</a></li>
<li class="toctree-l3"><a class="reference internal" href="#readability">Readability</a></li>
<li class="toctree-l3"><a class="reference internal" href="#maintainability">Maintainability</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#algorithm-safety-and-robustness">Algorithm Safety and Robustness</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#critical-issue-resolution-v1-3-1">Critical Issue Resolution (v1.3.1+)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-problem">The Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-solution">The Solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#safety-guarantees">Safety Guarantees</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-safe-complex-class-processing">Example: Safe Complex Class Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#user-experience">User Experience</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compatibility">Compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="#technical-implementation-details">Technical Implementation Details</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="privacy.html">Privacy Fixer System</a></li>
<li class="toctree-l1"><a class="reference internal" href="claude.html">Claude Code Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="validation-system.html">Documentation Validation System</a></li>
<li class="toctree-l1"><a class="reference internal" href="release.html">Release Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Development Roadmap</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pylint-sort-functions</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Function and Method Sorting Algorithm</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/hakonhagland/pylint-sort-functions/blob/main/docs/sorting.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="function-and-method-sorting-algorithm">
<h1>Function and Method Sorting Algorithm<a class="headerlink" href="#function-and-method-sorting-algorithm" title="Link to this heading"></a></h1>
<p>This document describes the comprehensive sorting algorithm used by pylint-sort-functions
to organize Python code for improved readability and maintainability.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>The plugin enforces a consistent organizational pattern for both module-level functions
and class methods. This creates predictable code structure that improves navigation
and reduces cognitive overhead when reading code.</p>
</section>
<section id="sorting-rules">
<h2>Sorting Rules<a class="headerlink" href="#sorting-rules" title="Link to this heading"></a></h2>
<section id="module-level-functions">
<h3>Module-Level Functions<a class="headerlink" href="#module-level-functions" title="Link to this heading"></a></h3>
<p>Functions within a module are organized using the following hierarchy:</p>
<ol class="arabic simple">
<li><p><strong>Public functions</strong> (no underscore prefix) - sorted alphabetically</p></li>
<li><p><strong>Private functions</strong> (single underscore prefix) - sorted alphabetically</p></li>
</ol>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Public functions (alphabetically sorted)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate_total</span><span class="p">(</span><span class="n">items</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">price</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">format_currency</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">amount</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">validate_input</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">data</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>

<span class="c1"># Private functions (alphabetically sorted)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_format_error_message</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_log_operation</span><span class="p">(</span><span class="n">operation</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Performing: </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="class-methods">
<h3>Class Methods<a class="headerlink" href="#class-methods" title="Link to this heading"></a></h3>
<p>Methods within classes follow the same organizational pattern:</p>
<ol class="arabic simple">
<li><p><strong>Public methods</strong> (including dunder methods) - sorted alphabetically</p></li>
<li><p><strong>Private methods</strong> (single underscore prefix) - sorted alphabetically</p></li>
</ol>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ShoppingCart</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">customer_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">customer_id</span> <span class="o">=</span> <span class="n">customer_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Cart for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">customer_id</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span><span class="si">}</span><span class="s2"> items&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_total</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">price</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">item_id</span><span class="p">]</span>

    <span class="c1"># Private methods</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_discount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">amount</span> <span class="o">*</span> <span class="mf">0.9</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_log_transaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transaction</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Transaction: </span><span class="si">{</span><span class="n">transaction</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="special-method-handling">
<h2>Special Method Handling<a class="headerlink" href="#special-method-handling" title="Link to this heading"></a></h2>
<section id="dunder-methods">
<h3>Dunder Methods<a class="headerlink" href="#dunder-methods" title="Link to this heading"></a></h3>
<p>Dunder methods (<code class="docutils literal notranslate"><span class="pre">__init__</span></code>, <code class="docutils literal notranslate"><span class="pre">__str__</span></code>, <code class="docutils literal notranslate"><span class="pre">__call__</span></code>, etc.) are treated as public methods
and are sorted alphabetically with other public methods. Due to their <code class="docutils literal notranslate"><span class="pre">__</span></code> prefix, they
naturally appear at the top of the public methods section.</p>
<p><strong>Rationale:</strong> Dunder methods are part of Python’s special method protocol and are considered
public API. Their alphabetical ordering ensures consistency while their double-underscore prefix
provides natural grouping at the top of classes.</p>
</section>
<section id="private-vs-public-classification">
<h3>Private vs Public Classification<a class="headerlink" href="#private-vs-public-classification" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Public:</strong> No underscore prefix (<code class="docutils literal notranslate"><span class="pre">method_name</span></code>)</p></li>
<li><p><strong>Public:</strong> Dunder methods (<code class="docutils literal notranslate"><span class="pre">__method_name__</span></code>)</p></li>
<li><p><strong>Private:</strong> Single underscore prefix (<code class="docutils literal notranslate"><span class="pre">_method_name</span></code>)</p></li>
</ul>
</section>
</section>
<section id="framework-integration">
<h2>Framework Integration<a class="headerlink" href="#framework-integration" title="Link to this heading"></a></h2>
<section id="decorator-exclusions">
<h3>Decorator Exclusions<a class="headerlink" href="#decorator-exclusions" title="Link to this heading"></a></h3>
<p>The plugin supports excluding functions/methods with specific decorators from sorting requirements.
This is essential for framework compatibility where decorator order matters.</p>
<p><strong>Common exclusion patterns:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Click commands - order may matter for help display</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">init</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">deploy</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="c1"># Flask routes - order may affect route matching</span>
<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/users&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">list_users</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/users/&lt;int:id&gt;&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_user</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p><strong>Configuration example:</strong></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.pylint.plugins]</span>
<span class="na">load-plugins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">[&quot;pylint_sort_functions&quot;]</span>

<span class="k">[tool.pylint.&quot;messages control&quot;]</span>
<span class="c1"># Enable all sorting checks</span>
<span class="na">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">[&quot;unsorted-functions&quot;, &quot;unsorted-methods&quot;, &quot;mixed-function-visibility&quot;]</span>

<span class="c1"># Configure decorator exclusions</span>
<span class="na">ignore-decorators</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">[&quot;@app.route&quot;, &quot;@*.command&quot;, &quot;@pytest.fixture&quot;]</span>
</pre></div>
</div>
</section>
</section>
<section id="privacy-detection">
<h2>Privacy Detection<a class="headerlink" href="#privacy-detection" title="Link to this heading"></a></h2>
<p>The plugin includes intelligent bidirectional privacy detection to suggest functions that have incorrect privacy levels.</p>
<p><strong>Bidirectional Analysis:</strong></p>
<ul class="simple">
<li><p><strong>W9004 Detection</strong>: Identifies public functions that should be private</p></li>
<li><p><strong>W9005 Detection</strong>: Identifies private functions that should be public</p></li>
</ul>
<section id="detection-algorithm">
<h3>Detection Algorithm<a class="headerlink" href="#detection-algorithm" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>Skip already private functions</strong> (start with <code class="docutils literal notranslate"><span class="pre">_</span></code>)</p></li>
<li><p><strong>Skip dunder methods</strong> (<code class="docutils literal notranslate"><span class="pre">__method__</span></code>)</p></li>
<li><p><strong>Skip common public API patterns:</strong></p>
<ul class="simple">
<li><p>Entry points: <code class="docutils literal notranslate"><span class="pre">main</span></code>, <code class="docutils literal notranslate"><span class="pre">run</span></code>, <code class="docutils literal notranslate"><span class="pre">execute</span></code></p></li>
<li><p>Lifecycle: <code class="docutils literal notranslate"><span class="pre">start</span></code>, <code class="docutils literal notranslate"><span class="pre">stop</span></code>, <code class="docutils literal notranslate"><span class="pre">setup</span></code>, <code class="docutils literal notranslate"><span class="pre">teardown</span></code></p></li>
</ul>
</li>
<li><p><strong>Analyze cross-module usage</strong> via import analysis</p></li>
<li><p><strong>Flag functions only used internally</strong> as privacy candidates</p></li>
</ol>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This function would be flagged for privacy</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate_tax_rate</span><span class="p">(</span><span class="n">income</span><span class="p">):</span>  <span class="c1"># Not imported by other modules</span>
    <span class="k">return</span> <span class="n">income</span> <span class="o">*</span> <span class="mf">0.15</span>

<span class="c1"># This function would NOT be flagged</span>
<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>  <span class="c1"># Entry point pattern</span>
    <span class="k">pass</span>

<span class="c1"># This function would NOT be flagged</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_user_data</span><span class="p">():</span>  <span class="c1"># Imported by user_service.py</span>
    <span class="k">pass</span>
</pre></div>
</div>
</section>
</section>
<section id="advanced-ast-based-boundary-detection">
<h2>Advanced AST-Based Boundary Detection<a class="headerlink" href="#advanced-ast-based-boundary-detection" title="Link to this heading"></a></h2>
<p>The auto-fix tool uses sophisticated AST (Abstract Syntax Tree) analysis to accurately detect boundaries between functions and other module constructs. This ensures proper handling of complex Python patterns.</p>
<p><strong>Accurate Boundary Detection:</strong></p>
<p>The system correctly handles various Python constructs:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Module-level constructs are properly preserved</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="n">CONSTANT</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">function_a</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="c1"># Comments and docstrings preserved</span>
<span class="sd">&quot;&quot;&quot;Module docstring after functions.&quot;&quot;&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">function_b</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyClass</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="c1"># Main blocks preserved at end of file</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Key Improvements:</strong></p>
<ul class="simple">
<li><p><strong>AST-Based Analysis</strong>: Uses Python’s AST to understand code structure instead of pattern matching</p></li>
<li><p><strong>Accurate End Detection</strong>: Finds actual function boundaries using AST node information</p></li>
<li><p><strong>Main Block Preservation</strong>: Correctly handles <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">&quot;__main__&quot;:</span></code> blocks</p></li>
<li><p><strong>Complex Constructs</strong>: Properly sorts around classes, global variables, and imports</p></li>
<li><p><strong>Docstring Handling</strong>: Preserves module-level docstrings and comments in correct positions</p></li>
</ul>
</section>
<section id="comment-preservation">
<h2>Comment Preservation<a class="headerlink" href="#comment-preservation" title="Link to this heading"></a></h2>
<p>The auto-fix tool preserves comments associated with functions during reordering:</p>
<p><strong>Before sorting:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">zebra_function</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="c1"># Important comment about alpha function</span>
<span class="c1"># This explains the algorithm</span>
<span class="k">def</span><span class="w"> </span><span class="nf">alpha_function</span><span class="p">():</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p><strong>After sorting:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Important comment about alpha function</span>
<span class="c1"># This explains the algorithm</span>
<span class="k">def</span><span class="w"> </span><span class="nf">alpha_function</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="k">def</span><span class="w"> </span><span class="nf">zebra_function</span><span class="p">():</span>
    <span class="k">pass</span>
</pre></div>
</div>
</section>
<section id="automatic-section-headers">
<h2>Automatic Section Headers<a class="headerlink" href="#automatic-section-headers" title="Link to this heading"></a></h2>
<p>The auto-fix tool can automatically insert section header comments to improve code organization
and make the visibility separation more explicit.</p>
<section id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Link to this heading"></a></h3>
<p>Section headers are configured through the <code class="docutils literal notranslate"><span class="pre">AutoFixConfig</span></code> class or CLI arguments:</p>
<p><strong>Programmatic Configuration:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pylint_sort_functions.auto_fix</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoFixConfig</span><span class="p">,</span> <span class="n">FunctionSorter</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">AutoFixConfig</span><span class="p">(</span>
    <span class="n">add_section_headers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                    <span class="c1"># Enable section headers</span>
    <span class="n">public_header</span><span class="o">=</span><span class="s2">&quot;# Public functions&quot;</span><span class="p">,</span>         <span class="c1"># Header for public functions</span>
    <span class="n">private_header</span><span class="o">=</span><span class="s2">&quot;# Private functions&quot;</span><span class="p">,</span>       <span class="c1"># Header for private functions</span>
    <span class="n">public_method_header</span><span class="o">=</span><span class="s2">&quot;# Public methods&quot;</span><span class="p">,</span>    <span class="c1"># Header for public methods</span>
    <span class="n">private_method_header</span><span class="o">=</span><span class="s2">&quot;# Private methods&quot;</span>   <span class="c1"># Header for private methods</span>
<span class="p">)</span>

<span class="n">sorter</span> <span class="o">=</span> <span class="n">FunctionSorter</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="n">sorter</span><span class="o">.</span><span class="n">sort_file</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;myfile.py&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p><strong>CLI Configuration:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enable section headers with default text</span>
pylint-sort-functions<span class="w"> </span>--fix<span class="w"> </span>--add-section-headers<span class="w"> </span>myfile.py

<span class="c1"># Customize header text</span>
pylint-sort-functions<span class="w"> </span>--fix<span class="w"> </span>--add-section-headers<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--public-header<span class="w"> </span><span class="s2">&quot;=== PUBLIC API ===&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--private-header<span class="w"> </span><span class="s2">&quot;=== INTERNAL HELPERS ===&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>myfile.py

<span class="c1"># Separate headers for functions vs methods</span>
pylint-sort-functions<span class="w"> </span>--fix<span class="w"> </span>--add-section-headers<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--public-method-header<span class="w"> </span><span class="s2">&quot;&gt;&gt;&gt; Public Methods &lt;&lt;&lt;&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--private-method-header<span class="w"> </span><span class="s2">&quot;&gt;&gt;&gt; Private Methods &lt;&lt;&lt;&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>myfile.py
</pre></div>
</div>
</section>
<section id="custom-section-header-detection">
<h3>Custom Section Header Detection<a class="headerlink" href="#custom-section-header-detection" title="Link to this heading"></a></h3>
<p>The auto-fix tool can detect and preserve existing section headers using configurable patterns.
This prevents duplication when section headers are already present and allows integration with
existing code organization styles.</p>
<p><strong>Configuration Options:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="n">AutoFixConfig</span><span class="p">(</span>
    <span class="n">add_section_headers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="c1"># Detection patterns for custom organizational styles</span>
    <span class="n">additional_section_patterns</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;=== API ===&quot;</span><span class="p">,</span>                    <span class="c1"># Custom delimiter style</span>
        <span class="s2">&quot;--- Helpers ---&quot;</span><span class="p">,</span>                <span class="c1"># Different delimiter</span>
        <span class="s2">&quot;## Core Functions ##&quot;</span><span class="p">,</span>           <span class="c1"># Markdown-style headers</span>
        <span class="s2">&quot;*** Private Implementation ***&quot;</span>  <span class="c1"># Alternative marker</span>
    <span class="p">],</span>
    <span class="c1"># Case sensitivity control (default: case-insensitive)</span>
    <span class="n">section_header_case_sensitive</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>CLI Usage:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add custom detection patterns</span>
pylint-sort-functions<span class="w"> </span>--fix<span class="w"> </span>--add-section-headers<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--additional-section-patterns<span class="w"> </span><span class="s2">&quot;=== API ===&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--additional-section-patterns<span class="w"> </span><span class="s2">&quot;--- Helpers ---&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>myfile.py

<span class="c1"># Enable case-sensitive detection</span>
pylint-sort-functions<span class="w"> </span>--fix<span class="w"> </span>--add-section-headers<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--section-headers-case-sensitive<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>myfile.py
</pre></div>
</div>
<p><strong>Detection Logic:</strong></p>
<p>The tool automatically detects section headers using a comprehensive pattern matching system:</p>
<ol class="arabic simple">
<li><p><strong>Configured Headers</strong>: Patterns from your <code class="docutils literal notranslate"><span class="pre">public_header</span></code>, <code class="docutils literal notranslate"><span class="pre">private_header</span></code>, etc. are automatically included</p></li>
<li><p><strong>Default Patterns</strong>: Backward-compatible patterns like “public functions”, “private methods”, etc.</p></li>
<li><p><strong>Additional Patterns</strong>: Your custom patterns via <code class="docutils literal notranslate"><span class="pre">additional_section_patterns</span></code></p></li>
<li><p><strong>Case Sensitivity</strong>: Configurable case-sensitive or case-insensitive matching</p></li>
</ol>
<p><strong>Example - Preserving Existing Headers:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Before: Existing file with custom headers</span>
<span class="sd">&quot;&quot;&quot;=== PUBLIC API ===&quot;&quot;&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">zebra_function</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;zebra&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">alpha_function</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;alpha&quot;</span>

<span class="sd">&quot;&quot;&quot;=== INTERNAL ===&quot;&quot;&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_private_helper</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;helper&quot;</span>

<span class="c1"># Configuration to detect these headers</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">AutoFixConfig</span><span class="p">(</span>
    <span class="n">add_section_headers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">public_header</span><span class="o">=</span><span class="s2">&quot;=== PUBLIC API ===&quot;</span><span class="p">,</span>
    <span class="n">private_header</span><span class="o">=</span><span class="s2">&quot;=== INTERNAL ===&quot;</span>
<span class="p">)</span>

<span class="c1"># After auto-fix: Headers preserved, functions sorted</span>
<span class="sd">&quot;&quot;&quot;=== PUBLIC API ===&quot;&quot;&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">alpha_function</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;alpha&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">zebra_function</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;zebra&quot;</span>

<span class="sd">&quot;&quot;&quot;=== INTERNAL ===&quot;&quot;&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_private_helper</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;helper&quot;</span>
</pre></div>
</div>
</section>
<section id="when-headers-are-added">
<h3>When Headers Are Added<a class="headerlink" href="#when-headers-are-added" title="Link to this heading"></a></h3>
<p>Section headers are automatically inserted <strong>only when both public and private functions/methods
exist in the same scope</strong>. This smart behavior ensures headers add value by clearly separating
different visibility levels, while avoiding unnecessary headers for single-visibility scopes.</p>
<p><strong>Headers added:</strong>
- Module with both public and private functions ✓
- Class with both public and private methods ✓</p>
<p><strong>Headers NOT added:</strong>
- Module with only public functions ✗
- Module with only private functions ✗
- Class with only public methods ✗
- Class with only private methods ✗</p>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h3>
<p><strong>Before auto-fix (unsorted mixed functions):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;User management module.&quot;&quot;&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">zebra_function</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A public function.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;zebra&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">alpha_function</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Another public function.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;alpha&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_zebra_private</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A private helper function.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;_zebra&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_alpha_private</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Another private helper.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;_alpha&quot;</span>
</pre></div>
</div>
<p><strong>After auto-fix with section headers enabled:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;User management module.&quot;&quot;&quot;</span>

<span class="c1"># Public functions</span>

<span class="k">def</span><span class="w"> </span><span class="nf">alpha_function</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Another public function.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;alpha&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">zebra_function</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A public function.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;zebra&quot;</span>


<span class="c1"># Private functions</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_alpha_private</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Another private helper.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;_alpha&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_zebra_private</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A private helper function.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;_zebra&quot;</span>
</pre></div>
</div>
<p><strong>Class method example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">UserService</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Service for user management.&quot;&quot;&quot;</span>

    <span class="c1"># Public methods</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_user_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch_from_db</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>


    <span class="c1"># Private methods</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_fetch_from_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">):</span>
        <span class="c1"># Database access logic</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_user_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="c1"># Validation logic</span>
        <span class="k">pass</span>
</pre></div>
</div>
</section>
</section>
<section id="message-types">
<h2>Message Types<a class="headerlink" href="#message-types" title="Link to this heading"></a></h2>
<p>The plugin reports five types of violations:</p>
<p><strong>Sorting Violations:</strong></p>
<section id="w9001-unsorted-functions">
<h3>W9001: unsorted-functions<a class="headerlink" href="#w9001-unsorted-functions" title="Link to this heading"></a></h3>
<p>Functions in a module are not sorted alphabetically within their visibility scope.</p>
</section>
<section id="w9002-unsorted-methods">
<h3>W9002: unsorted-methods<a class="headerlink" href="#w9002-unsorted-methods" title="Link to this heading"></a></h3>
<p>Methods in a class are not sorted alphabetically within their visibility scope.</p>
</section>
<section id="w9003-mixed-function-visibility">
<h3>W9003: mixed-function-visibility<a class="headerlink" href="#w9003-mixed-function-visibility" title="Link to this heading"></a></h3>
<p>Public and private functions are not properly separated (public must come before private).</p>
<p><strong>Privacy Violations:</strong></p>
</section>
<section id="w9004-function-should-be-private">
<h3>W9004: function-should-be-private<a class="headerlink" href="#w9004-function-should-be-private" title="Link to this heading"></a></h3>
<p>A public function should be marked as private (add underscore prefix) because it’s only used within its own module.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This function is only called within this module</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate_internal_hash</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>  <span class="c1"># W9004: Should be _calculate_internal_hash</span>
    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="w9005-function-should-be-public">
<h3>W9005: function-should-be-public<a class="headerlink" href="#w9005-function-should-be-public" title="Link to this heading"></a></h3>
<p>A private function should be made public (remove underscore prefix) because it’s imported and used by other modules.</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># utils.py</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_format_currency</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>  <span class="c1"># W9005: Should be format_currency</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="si">{</span><span class="n">amount</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># main.py imports it:</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">_format_currency</span>  <span class="c1"># External usage detected</span>
</pre></div>
</div>
</section>
</section>
<section id="pylint-integration">
<h2>PyLint Integration<a class="headerlink" href="#pylint-integration" title="Link to this heading"></a></h2>
<p>See <a class="reference internal" href="pylintrc.html"><span class="doc">PyLint Configuration</span></a> for complete configuration options including:</p>
<ul class="simple">
<li><p>Enabling/disabling specific message types</p></li>
<li><p>Configuring decorator exclusion patterns</p></li>
<li><p>Setting up auto-fix integration</p></li>
</ul>
</section>
<section id="cli-tool">
<h2>CLI Tool<a class="headerlink" href="#cli-tool" title="Link to this heading"></a></h2>
<p>See <a class="reference internal" href="cli.html"><span class="doc">Auto-Fix Tool Reference</span></a> for information about the standalone <code class="docutils literal notranslate"><span class="pre">pylint-sort-functions</span></code> command-line tool
that provides auto-fix functionality independent of PyLint.</p>
</section>
<section id="benefits">
<h2>Benefits<a class="headerlink" href="#benefits" title="Link to this heading"></a></h2>
<section id="consistency">
<h3>Consistency<a class="headerlink" href="#consistency" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Predictable function/method location</p></li>
<li><p>Reduced time searching for specific functions</p></li>
<li><p>Easier code reviews and maintenance</p></li>
</ul>
</section>
<section id="readability">
<h3>Readability<a class="headerlink" href="#readability" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Public API clearly separated from internal implementation</p></li>
<li><p>Alphabetical ordering eliminates arbitrary placement decisions</p></li>
<li><p>Natural grouping of related functionality</p></li>
</ul>
</section>
<section id="maintainability">
<h3>Maintainability<a class="headerlink" href="#maintainability" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>New functions have obvious placement location</p></li>
<li><p>Refactoring becomes more systematic</p></li>
<li><p>Codebase-wide organizational standards</p></li>
</ul>
</section>
</section>
</section>
<section id="algorithm-safety-and-robustness">
<h1>Algorithm Safety and Robustness<a class="headerlink" href="#algorithm-safety-and-robustness" title="Link to this heading"></a></h1>
<section id="critical-issue-resolution-v1-3-1">
<h2>Critical Issue Resolution (v1.3.1+)<a class="headerlink" href="#critical-issue-resolution-v1-3-1" title="Link to this heading"></a></h2>
<p><strong>GitHub Issue #25 Resolution</strong></p>
<p>Version 1.3.1 includes a comprehensive fix for a critical algorithm safety issue that could
cause syntax corruption when auto-sorting files with multiple complex class definitions.</p>
<section id="the-problem">
<h3>The Problem<a class="headerlink" href="#the-problem" title="Link to this heading"></a></h3>
<p>The original algorithm processed classes sequentially, which caused line number corruption
when multiple classes were present:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># BEFORE: This would cause corruption</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DialogA</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">z_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">a_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DialogB</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">z_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># Same name as DialogA</span>
        <span class="k">pass</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">a_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># Same name as DialogA</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p><strong>Result</strong>: Class <code class="docutils literal notranslate"><span class="pre">DialogB</span></code> definition would be lost, methods orphaned, syntax errors created.</p>
</section>
<section id="the-solution">
<h3>The Solution<a class="headerlink" href="#the-solution" title="Link to this heading"></a></h3>
<p><strong>Multi-Class Safe Processing Algorithm:</strong></p>
<ol class="arabic simple">
<li><p><strong>Upfront Data Extraction</strong>: Extract ALL class information before ANY modifications</p></li>
<li><p><strong>Reverse Processing Order</strong>: Process classes from end-to-start to preserve line numbers</p></li>
<li><p><strong>Mandatory Syntax Validation</strong>: Validate output and automatically rollback on errors</p></li>
<li><p><strong>Class Boundary Preservation</strong>: Ensure all class definitions remain intact</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># NEW ALGORITHM (simplified pseudocode):</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_sort_class_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">lines</span><span class="p">):</span>
    <span class="c1"># PHASE 1: Extract all class data upfront (NO modifications yet)</span>
    <span class="n">class_info</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">module</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">ClassDef</span><span class="p">):</span>
            <span class="n">method_spans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_method_spans</span><span class="p">(</span><span class="n">methods</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
            <span class="n">sorted_spans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sort_function_spans</span><span class="p">(</span><span class="n">method_spans</span><span class="p">)</span>
            <span class="n">class_info</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">node</span><span class="p">,</span> <span class="n">method_spans</span><span class="p">,</span> <span class="n">sorted_spans</span><span class="p">))</span>

    <span class="c1"># PHASE 2: Process in REVERSE ORDER (preserves line numbers)</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">original_spans</span><span class="p">,</span> <span class="n">sorted_spans</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">class_info</span><span class="p">):</span>
        <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reconstruct_class_with_sorted_methods</span><span class="p">(</span>
            <span class="n">content</span><span class="p">,</span> <span class="n">original_spans</span><span class="p">,</span> <span class="n">sorted_spans</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">content</span>
</pre></div>
</div>
<p><strong>Syntax Validation with Auto-Rollback:</strong></p>
<p>Every auto-sort operation now includes mandatory validation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_validate_syntax_and_rollback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">original_content</span><span class="p">,</span> <span class="n">new_content</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Critical safety measure to prevent corruption.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">compile</span><span class="p">(</span><span class="n">new_content</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">file_path</span><span class="p">),</span> <span class="s1">&#39;exec&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_content</span>
    <span class="k">except</span> <span class="ne">SyntaxError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WARNING: Auto-sort would create syntax error in </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Reverting to original content to prevent file corruption.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">original_content</span>
</pre></div>
</div>
</section>
<section id="safety-guarantees">
<h3>Safety Guarantees<a class="headerlink" href="#safety-guarantees" title="Link to this heading"></a></h3>
<p>The enhanced algorithm provides multiple safety layers:</p>
<dl class="simple">
<dt><strong>1. Data Integrity</strong></dt><dd><ul class="simple">
<li><p>No class definitions are ever lost</p></li>
<li><p>Method context is always preserved</p></li>
<li><p>super() calls remain properly associated with their classes</p></li>
</ul>
</dd>
<dt><strong>2. Automatic Error Recovery</strong></dt><dd><ul class="simple">
<li><p>Syntax validation after every transformation</p></li>
<li><p>Automatic rollback to original content on any error</p></li>
<li><p>Detailed error reporting with line numbers and context</p></li>
</ul>
</dd>
<dt><strong>3. Multi-Class Robustness</strong></dt><dd><ul class="simple">
<li><p>Handles complex inheritance hierarchies (PyQt, Django, etc.)</p></li>
<li><p>Preserves methods with identical names across different classes</p></li>
<li><p>Maintains proper indentation and class boundaries</p></li>
</ul>
</dd>
<dt><strong>4. Production Safety</strong></dt><dd><ul class="simple">
<li><p>Zero data loss risk - files are never left in corrupted state</p></li>
<li><p>Backward compatibility - simple cases continue to work as before</p></li>
<li><p>Comprehensive test coverage for complex scenarios</p></li>
</ul>
</dd>
</dl>
</section>
<section id="example-safe-complex-class-processing">
<h3>Example: Safe Complex Class Processing<a class="headerlink" href="#example-safe-complex-class-processing" title="Link to this heading"></a></h3>
<p><strong>Input (Complex Class Hierarchy):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">LicenseSelectionDialog</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Complex PyQt dialog with inheritance.&#39;&#39;&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Setup the user interface.&#39;&#39;&#39;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Initialize dialog.&#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>  <span class="c1"># CRITICAL: Must preserve class context</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">=</span> <span class="n">task</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">accept</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Accept dialog.&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result_value</span> <span class="o">=</span> <span class="s2">&quot;accepted&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_input</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Private validation method.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="kc">True</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AnotherDialog</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Another dialog with same method names.&#39;&#39;&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">accept</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># Same name as above - previously caused corruption</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Accept this dialog.&#39;&#39;&#39;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Initialize this dialog.&#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>  <span class="c1"># This also would break</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_helper_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Private helper.&#39;&#39;&#39;</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p><strong>Output (Safely Sorted):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">LicenseSelectionDialog</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Complex PyQt dialog with inheritance.&#39;&#39;&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Initialize dialog.&#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>  <span class="c1"># ✓ Preserved in correct class context</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task</span> <span class="o">=</span> <span class="n">task</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">accept</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Accept dialog.&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result_value</span> <span class="o">=</span> <span class="s2">&quot;accepted&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setup_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Setup the user interface.&#39;&#39;&#39;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_input</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Private validation method.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="kc">True</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AnotherDialog</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Another dialog with same method names.&#39;&#39;&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Initialize this dialog.&#39;&#39;&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>  <span class="c1"># ✓ Preserved in correct class context</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">accept</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># ✓ No longer conflicts with LicenseSelectionDialog.accept</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Accept this dialog.&#39;&#39;&#39;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_helper_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;Private helper.&#39;&#39;&#39;</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p><strong>Key Improvements Demonstrated:</strong></p>
<ul class="simple">
<li><p>✅ Both class definitions preserved intact</p></li>
<li><p>✅ Methods sorted within their respective classes</p></li>
<li><p>✅ super() calls maintain proper class context</p></li>
<li><p>✅ Method name conflicts resolved (accept() in both classes is now safe)</p></li>
<li><p>✅ Public/private method separation maintained in each class</p></li>
</ul>
</section>
<section id="user-experience">
<h3>User Experience<a class="headerlink" href="#user-experience" title="Link to this heading"></a></h3>
<p><strong>Before Fix</strong>: Silent corruption, manual git restore required
<strong>After Fix</strong>: Safe operation with helpful warnings</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pylint-sort-functions<span class="w"> </span>--fix<span class="w"> </span>--auto-sort<span class="w"> </span>complex_file.py
</pre></div>
</div>
<p>If any issues occur (extremely rare), you will see output like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">WARNING</span><span class="p">:</span> <span class="n">Auto</span><span class="o">-</span><span class="n">sort</span> <span class="n">would</span> <span class="n">create</span> <span class="n">syntax</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">complex_file</span><span class="o">.</span><span class="n">py</span><span class="p">:</span>
  <span class="n">Error</span><span class="p">:</span> <span class="n">invalid</span> <span class="n">syntax</span> <span class="p">(</span><span class="n">complex_file</span><span class="o">.</span><span class="n">py</span><span class="p">,</span> <span class="n">line</span> <span class="mi">25</span><span class="p">)</span>
  <span class="n">Line</span> <span class="mi">25</span><span class="p">:</span> <span class="k">class</span><span class="w"> </span><span class="nc">BrokenClass</span>
  <span class="n">Reverting</span> <span class="n">to</span> <span class="n">original</span> <span class="n">content</span> <span class="n">to</span> <span class="n">prevent</span> <span class="n">file</span> <span class="n">corruption</span><span class="o">.</span>
</pre></div>
</div>
<p>The file remains unchanged and safe.</p>
</section>
<section id="compatibility">
<h3>Compatibility<a class="headerlink" href="#compatibility" title="Link to this heading"></a></h3>
<p><strong>Supported Complex Patterns:</strong></p>
<ul class="simple">
<li><p>✅ <strong>PyQt/PySide Applications</strong>: Dialog classes, widget hierarchies</p></li>
<li><p>✅ <strong>Django Projects</strong>: Model classes, view classes with complex inheritance</p></li>
<li><p>✅ <strong>Flask Applications</strong>: Multiple route handler classes</p></li>
<li><p>✅ <strong>FastAPI Projects</strong>: Complex dependency injection patterns</p></li>
<li><p>✅ <strong>Data Science</strong>: Classes with complex method interdependencies</p></li>
<li><p>✅ <strong>Any Framework</strong>: Multi-class files with inheritance and super() calls</p></li>
</ul>
<p><strong>Testing Coverage:</strong></p>
<p>The fix includes comprehensive test coverage for:</p>
<ul class="simple">
<li><p>Complex multi-class inheritance scenarios</p></li>
<li><p>Methods with identical names across classes</p></li>
<li><p>super() call preservation in complex hierarchies</p></li>
<li><p>Multi-line method signatures and complex arguments</p></li>
<li><p>Mixed public/private method visibility patterns</p></li>
<li><p>Error recovery and rollback scenarios</p></li>
</ul>
<p>For technical details, see the test suite in <code class="docutils literal notranslate"><span class="pre">tests/test_issue25_syntax_corruption.py</span></code>.</p>
</section>
<section id="technical-implementation-details">
<h3>Technical Implementation Details<a class="headerlink" href="#technical-implementation-details" title="Link to this heading"></a></h3>
<p><strong>Root Cause Analysis:</strong></p>
<p>The original bug occurred because:</p>
<ol class="arabic simple">
<li><p><strong>Sequential Processing</strong>: Classes were processed one-by-one in order</p></li>
<li><p><strong>Content Modification</strong>: Each class modification changed line numbers for subsequent classes</p></li>
<li><p><strong>Stale References</strong>: Later classes used outdated line number information</p></li>
<li><p><strong>Boundary Loss</strong>: Method extraction from wrong positions caused class boundaries to dissolve</p></li>
</ol>
<p><strong>Fix Implementation:</strong></p>
<ol class="arabic simple">
<li><p><strong>Two-Phase Processing</strong>:
- Phase 1: Extract all class and method information using current line numbers
- Phase 2: Apply modifications in reverse order to preserve line number validity</p></li>
<li><p><strong>Comprehensive Validation</strong>:
- Syntax compilation test after every transformation
- Automatic rollback mechanism on any detected error
- Detailed logging for troubleshooting</p></li>
<li><p><strong>Robust Error Handling</strong>:
- Multiple fallback layers for different error types
- Preservation of original file in all error scenarios
- Clear user communication about any issues</p></li>
</ol>
<p><strong>Performance Impact:</strong></p>
<p>The safety improvements have minimal performance impact:</p>
<ul class="simple">
<li><p><strong>Small files</strong>: No measurable difference</p></li>
<li><p><strong>Large files</strong>: &lt;5% processing time increase</p></li>
<li><p><strong>Complex files</strong>: Better reliability far outweighs minimal performance cost</p></li>
</ul>
<p><strong>Future Maintenance:</strong></p>
<p>The enhanced algorithm is designed for long-term maintainability:</p>
<ul class="simple">
<li><p><strong>Comprehensive test coverage</strong> prevents regressions</p></li>
<li><p><strong>Clear separation of concerns</strong> makes modifications safer</p></li>
<li><p><strong>Detailed documentation</strong> aids future development</p></li>
<li><p><strong>Robust error handling</strong> provides diagnostic information for edge cases</p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pylintrc.html" class="btn btn-neutral float-left" title="PyLint Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Håkon Hægland.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>